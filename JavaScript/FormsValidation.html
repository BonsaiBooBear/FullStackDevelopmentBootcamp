<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="dark light">
    <title>Forms Validation</title>
    <script src="https://kit.fontawesome.com/cc383de1b1.js" crossorigin="anonymous"></script>
    <style>
      form {
        background-color: cadetblue;
        padding: 1em;
        border-radius: 6px;
        width: max-content;
        margin: 2em auto;
        font-family: 'Times New Roman', Times, serif;
      }

      form h2 {
        margin: 0 0 0.5em;
        font-size: 1.5rem;
        text-align: center;
      }

      /* Child Combinator (>) to ensure only the direct descendant is selected */
      form > div {
        margin: 1em 0;
        display: flex;
        justify-content: space-between;
        gap: 1em;
      }

      form input{
        border: none;
        border-radius: 2px;
        font-size: 0.75em;
      }
    </style>
  </head>
  <body>
    <h1>Forms Validation</h1>
    <form>
      <h2>Registration Form</h2>
      <div>
        <label for="name">Name</label>
        <input type="text" placeholder="Enter your full name" id="name" autocomplete="off">
      </div>
      <div>
        <label for="email">Email</label>
        <input type="text" placeholder="Enter your email" id="email" autocomplete="off">
      </div>
      <div>
        <label for="password">Password</label>
        <input type="password" placeholder="Enter your password" id="password" autocomplete="off">
      </div>
      <div>
        <label for="confirm-password">Confirm Password</label>
        <input type="password" placeholder="Re-enter your password" id="confirm-password" autocomplete="off">
      </div>
      <div>
        <label>Gender</label>
        <div>
          <input type="radio" name="gender" value="male" class="gender">Male
          <input type="radio" name="gender" value="female" class="gender">Female
          <input type="radio" name="gender" value="other" class="gender">Other
        </div>
      </div>
      <div>
        <label>Hobbies</label>
        <div>
          <input type="checkbox" name="hobby" value="swim" class="hobby">Swim
          <input type="checkbox" name="hobby" value="dance" class="hobby">Dance
          <input type="checkbox" name="hobby" value="sing" class="hobby">Sing
        </div>
      </div>
      <div>
        <label>Bio</label>
        <textarea rows="5" placeholder="Enter your bio" id="bio"></textarea>
      </div>
      <div>
        <label>Education</label>
        <select id="education">
          <option value="">Select</option>
          <option value="POST GRADUATE">Post Graduate</option>
          <option value="GRADUATE">Graduate</option>
          <option value="UNDER GRADUATE">Under Graduate</option>
        </select>
      </div>
      <div style="justify-content: center;">
        <button type="button" onclick="handleFormData()">Submit</button>
      </div>
    </form>

    <script>
      function handleFormData() {
        const name = document.getElementById('name').value
        const email = document.getElementById('email').value
        const password = document.getElementById('password').value
        const confirmPassword = document.getElementById('confirm-password').value

        const genderOptions = document.getElementsByClassName('gender')
        const selectedGender = Array.from(genderOptions).find(genderOption => {
          return genderOption.checked == true
        })

        const hobbyOptions = document.getElementsByClassName('hobby')
        const selectedHobbies = Array.from(hobbyOptions).filter(hobbyOption => {
          return hobbyOption.checked
        }).map(h => h.value) // same as selectedHobbies = selectedHobbies.map (h => { return h.value })

        const bio = document.getElementById("bio").value
        const education = document.getElementById("education").value

        const userData = { name, email, password, confirmPassword, gender: selectedGender && selectedGender.value, hobbies: selectedHobbies, bio, education }

        console.log('User data collected', userData)

        const result = validateFormData(userData)
        console.log(result)
      }

      function validateFormData(userData) {
        const {name, email, password, confirmPassword, gender, hobbies, bio, education} = userData

        // 1. NAME
        if(!name || name.length < 3) { // Not empty and at least 3 characters
          return 'Invalid name'
        }

        for (let i=0; i<name.length; i++) { // No special characters or digits
          if(name[i] >= '!' && name[i] <= '@') { //ASCII 33-64
            return 'Invalid name' 
          }
        }

        // 2. EMAIL
        if(!email || !email.includes('@') || !email.includes('.') || email.indexOf('@') < 2) {
          return 'Invalid email'
        }

        const lastDotIndex = email.lastIndexOf('.')
        const lastCharIndex = email.length-1
        if(lastCharIndex - lastDotIndex > 3) {
          return 'Invalid email'
        }

        // const parts = email.split('.')
        // const last = parts[part.length-1]
        // if(las.length > 3) {
        //   return 'Invalid email'
        // }

        
        // 3. PASSWORD & CONFIRMED PASSWORD
        if(!password) {
          return 'Please enter Password'
        }
        
        if (!confirmPassword) {
          return 'Please confirm the Password'
        }
        
        if (password != confirmPassword) {
          return 'Passwords do not match'
        }

        // 4. GENDER
        if(!gender) {
          return 'Please select Gender'
        }

        // 5. HOBBIES
        if(!hobbies.length) {
          return 'Please select at least 1 Hobby'
        }

        // 6. BIO
        if(!bio || bio.length < 100) {
          return 'Invalid Bio'
        }

        // 7. EDUCATION
        if(!education) {
          return 'Please select level of Education'
        }

        return 'FORM VALIDATED SUCCESSFULLY'
      }

    </script>
  </body>
</html>
<br><br><br><br>
<hr>

<h2>Notes From Live Session</h2>
<pre>
/*
  #  Validation rules:
    1. Name:
      - Cannot be empty
      - At least 3 characters
      - No special characters
      - No digits
    2. Email
      - Cannot be empty
      - Should have @
      - Should have .
      - At most 3 characters after .
      - At least 2 characters before @
    3. Password (Password Strength Checker Project)
    4. Gender (1 selection)
    5. Hobbies (1 selection)
    6. Bio
      - Cannot be empty
      - At least 100 characters
    7. Education (1 selection)



*/
</pre>